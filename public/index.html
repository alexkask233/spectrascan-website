<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üõ°Ô∏è SpectraScan - Expose Fraud & Antidetect Browsers</title>
  <link rel="icon" href="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20384%20512'%3E%3Cpath%20fill='%23000000'%20d='M256%200C114.6%200%200%20114.6%200%20256s114.6%20256%20256%20256s256-114.6%20256-256S397.4%200%20256%200zM192%20160a32%2032%200%201%201-64%200%2032%2032%200%201%201%2064%200zm128%200a32%2032%200%201%201-64%200%2032%2032%200%201%201%2064%200zM160%20336H352c8.8%200%2016%207.2%2016%2016s-7.2%2016-16%2016H160c-8.8%200-16-7.2-16-16s7.2-16%2016-16z'/%3E%3C/svg%3E">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  
  <script src="https://cdn.jsdelivr.net/npm/@thumbmarkjs/thumbmarkjs/dist/thumbmark.umd.js"></script>

  <style>
    :root {
      --bg-color: #0d0d12; --card-color: rgba(22, 22, 28, 0.9); --border-color: #33333a; --text-primary: #f0f0f0; --text-secondary: #a9a9b3; --accent-green: #00ff88; --accent-red: #ff4757; --accent-blue: #00aaff; --success-bg: rgba(0, 255, 136, 0.1); --danger-bg: rgba(255, 71, 87, 0.1);
    }
    body.light-mode {
      --bg-color: #f4f4f8; --card-color: #ffffff; --border-color: #e0e0e6; --text-primary: #121217; --text-secondary: #66666e; --success-bg: rgba(0, 200, 110, 0.1); --danger-bg: rgba(255, 71, 87, 0.1);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { height: 100%; }
    body { height: 100%; background-color: var(--bg-color); color: var(--text-primary); font-family: 'Inter', sans-serif; line-height: 1.6; position: relative; }
    #matrix-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2; transition: opacity 0.5s ease-in-out; }
    .page-wrapper { display: flex; flex-direction: column; min-height: 100vh; }
    main { flex-grow: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 40px 20px; }
    .page { display: none; width: 100%; max-width: 800px; }
    .page.active { display: block; animation: page-transition-in 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; }
    @keyframes page-transition-in { from { opacity: 0; transform: translateY(20px) scale(0.98); } to { opacity: 1; transform: translateY(0) scale(1); } }
    header { background-color: rgba(18, 18, 23, 0.8); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border-bottom: 1px solid var(--border-color); padding: 0 40px; display: flex; justify-content: space-between; align-items: center; height: 70px; position: sticky; top: 0; z-index: 100; transition: background-color 0.3s ease, border-color 0.3s ease; }
    .logo-link { text-decoration: none; }
    .logo { font-size: 20px; font-weight: 700; display: flex; align-items: center; gap: 10px; color: var(--text-primary); }
    .logo .fa-shield-halved { color: var(--accent-green); }
    nav { display: flex; align-items: center; gap: 30px; }
    nav .nav-link { color: var(--text-secondary); text-decoration: none; font-weight: 500; transition: color 0.2s ease; }
    nav .nav-link:hover, nav .nav-link.active { color: var(--text-primary); }
    #theme-toggle-btn { background: none; border: none; color: var(--text-secondary); font-size: 20px; cursor: pointer; transition: color 0.2s ease, transform 0.2s ease; }
    #hamburger-btn, #close-nav-btn { display: none; background: none; border: none; font-size: 24px; color: var(--text-primary); cursor: pointer; }
    #close-nav-btn { position: absolute; top: 20px; right: 20px; }
    footer { text-align: center; padding: 20px; color: var(--text-secondary); font-size: 14px; background-color: transparent; border-top: 1px solid var(--border-color); font-family: 'Roboto Mono', monospace; transition: background-color 0.3s ease, border-color 0.3s ease; }
    footer .footer-icons { margin-top: 10px; display: flex; justify-content: center; gap: 20px; font-size: 18px; color: var(--accent-green); }
    .container { background-color: var(--card-color); padding: 30px 40px; border-radius: 16px; border: 1px solid var(--border-color); box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2); transition: background-color 0.3s ease, border-color 0.3s ease; position: relative; overflow: hidden; }
    h1 { font-size: 2.5rem; font-weight: 700; margin-bottom: 10px; text-align: center; color: var(--text-primary); position: relative; }
    .sub-headline { font-family: 'Roboto Mono', monospace; font-size: 16px; color: var(--text-secondary); text-align: center; margin-bottom: 30px; max-width: 600px; margin-left: auto; margin-right: auto; }
    .sub-headline span { color: var(--accent-green); text-shadow: 0 0 5px rgba(0,255,136,0.5); }
    .run-btn-wrapper { margin-top: 40px; text-align:center; }
    button#run-btn, button#reset-btn { background: var(--accent-green); color: #000; box-shadow: 0 0 15px rgba(0, 255, 136, 0.3); padding: 15px 35px; font-size: 18px; font-weight: 700; border: none; border-radius: 10px; animation: pulse-glow 2s infinite alternate; cursor:pointer; font-family: 'Inter', sans-serif; transition: all 0.3s ease; }
    button#run-btn:hover { background-color: #00e67a; transform: translateY(-3px) scale(1.02); box-shadow: 0 0 25px rgba(0, 255, 136, 0.6); animation-play-state: paused; }
    @keyframes pulse-glow { from { box-shadow: 0 0 10px rgba(0, 255, 136, 0.3); } to { box-shadow: 0 0 25px rgba(0, 255, 136, 0.7); } }
    .detection-showcase { padding: 50px 0; border-top: 1px solid var(--border-color); margin-top: 50px; }
    .showcase-title { text-align: center; font-family: 'Roboto Mono', monospace; font-size: 1.5rem; color: var(--text-primary); margin-bottom: 30px; }
    .showcase-title .fa-crosshairs { color: var(--accent-red); margin-right: 10px; animation: pulse-glow 3s infinite alternate; }
    .detection-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 25px; }
    .detection-card { background: transparent; border: 1px solid var(--border-color); border-radius: 12px; padding: 25px; text-align: center; transition: all 0.3s ease-in-out; }
    .detection-card:hover { transform: translateY(-5px); border-color: var(--accent-green); box-shadow: 0 0 20px rgba(0, 255, 136, 0.3); }
    .detection-card .fa-icon { font-size: 2rem; color: var(--accent-green); margin-bottom: 15px; text-shadow: 0 0 10px rgba(0,255,136,0.5); }
    .detection-card h3 { font-family: 'Inter', sans-serif; font-size: 1.2rem; color: var(--text-primary); margin-bottom: 15px; }
    .detection-card ul { list-style: none; padding: 0; }
    .detection-card ul li { font-family: 'Roboto Mono', monospace; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.8; }
    #results-wrapper { margin-top: 40px; width: 100%; }
    #results-container { text-align: left; }
    .verdict-box { padding: 20px; font-size: 22px; font-weight: 700; border-radius: 12px; border: 2px solid; display: flex; align-items: center; justify-content: center; gap: 15px; margin-bottom: 25px; animation: pulse-border 2s infinite; }
    .verdict-box.safe { background-color: var(--success-bg); border-color: var(--accent-green); color: var(--accent-green); }
    .verdict-box.danger { background-color: var(--danger-bg); border-color: var(--accent-red); color: var(--accent-red); }
    @keyframes pulse-border { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.01); } }
    .risk-score { font-size: 16px; color: var(--text-secondary); text-align: center; margin-bottom: 25px; }
    .risk-score strong { color: var(--text-primary); font-weight: 700; font-size: 18px; }
    .details-grid { display: grid; grid-template-columns: auto 1fr; gap: 12px 20px; padding: 20px 0; border-top: 1px solid var(--border-color); font-family: 'Roboto Mono', monospace; align-items: baseline; }
    .details-grid .label { color: var(--text-secondary); text-align: right; white-space: pre; font-size: 14px; }
    .details-grid .value { color: var(--text-primary); font-size: 14px; word-break: break-all; }
    .details-grid .value.danger { color: var(--accent-red); font-weight: 700; }
    .details-grid .value.safe { color: var(--accent-green); }
    .results-footer { text-align: center; padding-top: 30px; }
    button#reset-btn { background-color: transparent; border: 2px solid var(--accent-red); color: var(--accent-red); }
    button#reset-btn.safe-button { border-color: var(--accent-green); color: var(--accent-green); }
    button#reset-btn:hover { color: #000; background: var(--accent-red); }
    button#reset-btn.safe-button:hover { color: #000; background: var(--accent-green); }
    .loader-wrapper { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 80px 0; overflow: hidden; }
    .glitch-text { color: var(--accent-red); font-family: 'Roboto Mono', monospace; font-size: 1.5rem; text-transform: uppercase; letter-spacing: 2px; position: relative; }
    .glitch-text::before, .glitch-text::after { content: 'ANALYZING SIGNATURE...'; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg-color); overflow: hidden; }
    .glitch-text::before { left: 2px; text-shadow: -2px 0 var(--accent-red); clip: rect(44px, 450px, 56px, 0); animation: glitch-anim 2s infinite linear alternate-reverse; }
    .glitch-text::after { left: -2px; text-shadow: -2px 0 var(--accent-blue), 2px 2px var(--accent-green); clip: rect(86px, 450px, 100px, 0); animation: glitch-anim2 3s infinite linear alternate-reverse; }
    @keyframes glitch-anim { from { clip: rect(5px, 9999px, 82px, 0); } to { clip: rect(78px, 9999px, 8px, 0); } }
    @keyframes glitch-anim2 { from { clip: rect(57px, 9999px, 34px, 0); } to { clip: rect(27px, 9999px, 100px, 0); } }
    .scanner-bar { width: 100%; height: 4px; background-color: var(--accent-green); margin-top: 30px; position: relative; box-shadow: 0 0 10px var(--accent-green); animation: scan-animation 2s linear infinite; }
    @keyframes scan-animation { from { transform: translateX(-100%); } to { transform: translateX(100%); } }
    
    .static-page p { color: var(--text-secondary); margin-bottom: 20px; line-height: 1.7; font-family: 'Roboto Mono', monospace; }
    .static-page h3 { color: var(--accent-blue); margin-top: 30px; margin-bottom: 10px; font-family: 'Roboto Mono', monospace; }
    .contact-form .form-group { margin-bottom: 20px; }
    .contact-form input, .contact-form textarea { width: 100%; background-color: var(--bg-color); border: 1px solid var(--border-color); border-radius: 8px; padding: 12px; color: var(--text-primary); font-size: 15px; transition: all 0.2s ease; font-family: 'Roboto Mono', monospace; }
    .contact-form input:focus, .contact-form textarea:focus { outline: none; border-color: var(--accent-blue); box-shadow: 0 0 10px rgba(0,170,255,0.5); }
    .contact-form textarea { resize: vertical; min-height: 120px; }
    .captcha-group { display: flex; align-items: center; flex-wrap: nowrap; gap: 15px; background-color: var(--bg-color); padding: 10px; border-radius: 8px; border: 1px solid var(--border-color); }
    .captcha-group label { color: var(--accent-green); font-family: 'Roboto Mono', monospace; white-space: nowrap; }
    .captcha-group input { border: none !important; box-shadow: none !important; }
    .form-submit-btn { width: 100%; padding: 15px; background: var(--accent-blue); color: #fff; border: none; border-radius: 10px; font-weight: 700; font-size: 16px; box-shadow: 0 0 15px rgba(0,170,255, 0.3); transition: all 0.3s ease; }
    .form-submit-btn:hover:not(:disabled) { background-color: #0099e6; transform: translateY(-2px); box-shadow: 0 0 25px rgba(0,170,255, 0.6); }
    .form-submit-btn:disabled { background-color: var(--text-secondary); cursor: not-allowed; }
    #form-response { text-align: center; margin-top: 15px; font-weight: 700; }
    #form-response.success { color: var(--accent-green); }
    #form-response.error { color: var(--accent-red); }

    @media (max-width: 768px) {
        h1, .static-page h2 { font-size: 1.8rem; }
        .detection-grid { grid-template-columns: 1fr; }
        header { padding: 0 20px; }
        nav .nav-link, nav #theme-toggle-btn { display: none; }
        #hamburger-btn { display: block; }
        nav { position: fixed; top: 0; right: -100%; width: 100%; height: 100vh; background: rgba(18, 18, 23, 0.95); backdrop-filter: blur(10px); flex-direction: column; justify-content: center; align-items: center; gap: 40px; transition: right 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
        nav.is-open { right: 0; }
        nav.is-open .nav-link, nav.is-open #theme-toggle-btn, nav.is-open #close-nav-btn { display: block; font-size: 24px; }
        .container { padding: 20px; }
    }
  </style>
</head>
<body>
<canvas id="matrix-bg"></canvas>
<div id="background-watermark"></div>

<audio id="scan-start-sound" src="data:audio/mp3;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA="></audio>
<audio id="scan-complete-sound" src="data:audio/mp3;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YRIggGz5f/V++f8F//X/t/yJ/tD8yP6Q/BD/Ov8f/Br/Lv9j/y7/Gf89/zr/QP83/zb/N/8t/y3/Jv8j/yH/Gv8W/w=="></audio>

<div class="page-wrapper">
  <header>
    <a href="/" class="logo-link">
      <div class="logo">
        <i class="fa-solid fa-shield-halved"></i>
        <span>SpectraScan</span>
      </div>
    </a>
    <button id="hamburger-btn" aria-label="Open menu"><i class="fa-solid fa-bars"></i></button>
    <nav id="main-nav">
        <button id="close-nav-btn" aria-label="Close menu"><i class="fa-solid fa-times"></i></button>
        <a href="/" class="nav-link">Catcher</a>
        <a href="/faq" class="nav-link">FAQ</a>
        <a href="/privacy" class="nav-link">Privacy</a>
        <a href="/contact" class="nav-link">Contact</a>
        <button id="theme-toggle-btn" title="Toggle theme"><i class="fa-solid fa-moon"></i></button>
    </nav>
  </header>

  <main>
    <div id="page-catcher" class="page">
      <div id="intro-content">
        <h1>Identify, Expose, Dominate.</h1>
        <p class="sub-headline">Unmask fraudulent users and eliminate threats by exposing <span>antidetect browsers</span> and <span>proxy networks</span>.</p>
        <div class="run-btn-wrapper">
          <button id="run-btn" onclick="runDetection()">Initiate Scan</button>
        </div>
      </div>
      
      <div id="results-wrapper" style="display: none;">
          <div class="container" id="results-container"></div>
      </div>

      <div class="detection-showcase">
        <h2 class="showcase-title"><i class="fa-solid fa-crosshairs"></i> Target Capabilities</h2>
        <div class="detection-grid">
          <div class="detection-card">
            <div class="fa-icon"><i class="fa-solid fa-user-secret"></i></div>
            <h3>Antidetect Browsers</h3>
            <ul><li>AdsPower</li><li>GoLogin</li><li>Multilogin</li><li>Incogniton</li><li>And more...</li></ul>
          </div>
          <div class="detection-card">
            <div class="fa-icon"><i class="fa-solid fa-network-wired"></i></div>
            <h3>Proxy & VPN Networks</h3>
            <ul><li>Oxylabs</li><li>Bright Data</li><li>IPRoyal</li><li>Datacenter/Residential</li><li>TOR Exit Nodes</li></ul>
          </div>
        </div>
      </div>
    </div>
    
    <div id="page-faq" class="page">
        <div class="container static-page">
          <h2>Frequently Asked Questions</h2>
          <h3>What is this tool?</h3><p>SpectraScan analyzes your browser's fingerprint for signs of manipulation. Websites use these fingerprints to track you. Our tool checks for common spoofing techniques and flags connections from known VPNs or proxies.</p>
          <h3>Why is a high risk score bad?</h3><p>A high score suggests your fingerprint is inconsistent, a common trait of antidetect browsers. While used for privacy, these browsers are often flagged as fraudulent by platforms like banks and e-commerce sites.</p>
          <h3>Is this 100% accurate?</h3><p>No tool is infallible in the cat-and-mouse game of browser security. This tool provides a strong, indicative analysis, not absolute proof.</p>
        </div>
    </div>
    
    <div id="page-privacy" class="page">
        <div class="container static-page">
            <h2>Privacy Policy</h2>
            <p>Your privacy is paramount. Our policy is simple: we don't store your data.</p>
            <h3>IP Address Handling</h3><p>Your IP address is used *only* to perform the check with third-party databases during your session. It is never logged or stored on our servers.</p>
            <h3>Browser Fingerprint</h3><p>All fingerprinting happens in your browser. Raw data (WebGL, Canvas, etc.) is never sent to us. Your device performs the analysis locally.</p>
            <h3>Cookies & Tracking</h3><p>This website does not use cookies for tracking. Period.</p>
        </div>
    </div>

    <div id="page-contact" class="page">
      <div class="container static-page">
        <h2>Initiate Contact</h2>
        <p>Your transmission will be relayed to our secure channel. Ensure your message is concise and accurate.</p>
        <form id="contact-form" class="contact-form">
          <div class="form-group"><input type="text" id="contact-name" name="name" placeholder="// Callsign (Name)" required></div>
          <div class="form-group"><input type="email" id="contact-email" name="email" placeholder="// Secure email for reply" required></div>
          <div class="form-group"><input type="text" id="contact-title" name="title" placeholder="// Subject of transmission" required></div>
          <div class="form-group"><textarea id="contact-description" name="description" placeholder="// Encrypted message..." required></textarea></div>
          <div class="form-group captcha-group">
            <label id="captcha-label" for="captcha-input"></label>
            <input type="text" id="captcha-input" name="captcha" placeholder="> " required autocomplete="off">
          </div>
          <button type="submit" id="submit-btn" class="form-submit-btn">Transmit Securely</button>
          <div id="form-response"></div>
        </form>
      </div>
    </div>

  </main>
  
  <footer>
    CLASSIFIED // FOR ANALYTICAL PURPOSES ONLY
    <div class="footer-icons">
      <i class="fa-solid fa-fingerprint"></i>
      <i class="fa-solid fa-bug"></i>
      <i class="fa-solid fa-user-secret"></i>
    </div>
  </footer>
</div>

<script>
  /* --- CORE SITE LOGIC --- */
  const hamburgerBtn = document.getElementById('hamburger-btn'); 
  const closeNavBtn = document.getElementById('close-nav-btn'); 
  const mainNav = document.getElementById('main-nav');
  hamburgerBtn.addEventListener('click', () => mainNav.classList.add('is-open'));
  closeNavBtn.addEventListener('click', () => mainNav.classList.remove('is-open'));
  const themeToggleBtn = document.getElementById('theme-toggle-btn'); 
  const body = document.body; 
  function applySavedTheme() { 
    const savedTheme = localStorage.getItem('theme'); 
    if (savedTheme === 'light') { 
      body.classList.add('light-mode'); 
      themeToggleBtn.innerHTML = '<i class="fa-solid fa-sun"></i>';
    } else { 
      body.classList.remove('light-mode'); 
      themeToggleBtn.innerHTML = '<i class="fa-solid fa-moon"></i>';
    } 
  }
  themeToggleBtn.addEventListener('click', () => { 
    body.classList.toggle('light-mode'); 
    const isLight = body.classList.contains('light-mode');
    localStorage.setItem('theme', isLight ? 'light' : 'dark');
    themeToggleBtn.innerHTML = isLight ? '<i class="fa-solid fa-sun"></i>' : '<i class="fa-solid fa-moon"></i>';
    setBackgroundState('default');
  });
  const pageContent = { '/': 'page-catcher', '/faq': 'page-faq', '/privacy': 'page-privacy', '/contact': 'page-contact' };
  function showPageContent(pageId) {
    document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
    const pageEl = document.getElementById(pageId);
    if(pageEl) pageEl.classList.add('active');
    document.querySelectorAll('.nav-link').forEach(link => {
      link.classList.remove('active');
      const linkPath = link.getAttribute('href');
      const currentPath = window.location.pathname;
      if (linkPath === currentPath || (currentPath === '/' && linkPath === '/')) { link.classList.add('active'); }
    });
  }
  const router = () => { const path = window.location.pathname; const pageId = pageContent[path] || 'page-catcher'; showPageContent(pageId); };
  document.addEventListener('click', (e) => { 
    const a = e.target.closest('a'); 
    if (a && (a.matches('.nav-link') || a.matches('.logo-link'))) { e.preventDefault(); history.pushState(null, '', a.href); mainNav.classList.remove('is-open'); router(); }
  });
  window.addEventListener('popstate', router);
  document.addEventListener('DOMContentLoaded', () => { applySavedTheme(); router(); if (document.getElementById('contact-form')) { initializeContactForm(); } });

  /* --- CATCHER SCRIPT --- */
  function showIntro() {
      document.getElementById('intro-content').style.display = 'block';
      document.getElementById('detection-showcase').style.display = 'block';
      document.getElementById('results-wrapper').style.display = 'none';
      setBackgroundState('default');
  }

  window.runDetection = async function() {
    document.getElementById('scan-start-sound').play();
    document.getElementById('intro-content').style.display = 'none';
    document.getElementById('detection-showcase').style.display = 'none';
    const resultsWrapper = document.getElementById('results-wrapper');
    const resultsEl = document.getElementById('results-container');
    resultsWrapper.style.display = 'block';
    resultsEl.innerHTML = `<div class="loader-wrapper"><div class="glitch-text">ANALYZING SIGNATURE...</div><div class="scanner-bar"></div></div>`;
    setBackgroundState('scanning');

    const minDelay = new Promise(resolve => setTimeout(resolve, 2500));
    
    const detectionPromise = (async () => {
        let riskScore = 0;
        let identifiedBrowserLabel = null;
        let heuristicsScore = 0;
        const riskFactors = [];
        const TARGET_CHROME_VERSION = "138"; 

        try {
            const resp = await fetch('/api/ip-check', { cache: 'no-store' });
            const ipData = await resp.json();
            riskFactors.push({ label: 'IP Address', value: ipData.ip, isBad: false, alwaysShow: true });
            riskFactors.push({ label: 'VPN/Proxy', value: ipData.status, isBad: ipData.isProxy, alwaysShow: true });
            if (ipData.isProxy) riskScore += 3;
            if (ipData.status.includes('TOR')) riskScore += 5;
        } catch (e) {
            riskScore++;
            riskFactors.push({ label: 'IP/VPN Check', value: "Error", isBad: true, alwaysShow: true });
        }

        const ua = navigator.userAgent;
        const majorChromeVersion = (ua.match(/Chrome\/(\d+)/) || [])[1];
        if (navigator.brave && await navigator.brave.isBrave()) {
            riskScore += 3;
            identifiedBrowserLabel = 'Brave';
        } else if (getCanvasEntropy() === 2001009873) {
             riskScore += 5;
             identifiedBrowserLabel = 'Tor';
        } else if (typeof window.opr !== 'undefined' || ua.includes("OPR")) {
             riskScore += 2;
             identifiedBrowserLabel = 'Opera';
        }
        if (identifiedBrowserLabel) { riskFactors.push({ label: 'Browser', value: identifiedBrowserLabel, isBad: true }); }

        if (!ua.includes("Chrome") || majorChromeVersion !== TARGET_CHROME_VERSION) { heuristicsScore += 4; }
        if (navigator.webdriver) { heuristicsScore += 4; }
        if (navigator.plugins && navigator.plugins.length === 5) { heuristicsScore += 1; }
        if (navigator.languages && navigator.languages.length === 4) { heuristicsScore += 2; }
        const proResolutions = ['1920x1080', '2560x1440', '3840x2160'];
        const currentRes = `${window.screen.width}x${window.screen.height}`;
        if (majorChromeVersion === TARGET_CHROME_VERSION && !proResolutions.includes(currentRes)) { heuristicsScore += 2; }
        riskScore += heuristicsScore;
        if (!identifiedBrowserLabel && heuristicsScore >= 4) { riskFactors.push({ label: 'Browser', value: 'Antidetect', isBad: true }); }
        const canvasHash1 = getCanvasEntropy();
        await new Promise(resolve => setTimeout(resolve, 30));
        const canvasHash2 = getCanvasEntropy();
        if (canvasHash1 !== canvasHash2) { riskScore += 2; riskFactors.push({ label: 'Canvas', value: 'Randomized', isBad: true }); }
        const renderer = getWebGLInfo().renderer.toLowerCase();
        if (renderer.includes("swiftshader") || renderer.includes("llvmpipe")) { riskScore += 3; riskFactors.push({ label: 'WebGL', value: "Software Emulated", isBad: true }); }

        let thumbmarkFingerprint = 'N/A';
        try { thumbmarkFingerprint = await ThumbmarkJS.getFingerprint(); } catch (err) {}
        riskFactors.push({ label: 'FP Hash', value: thumbmarkFingerprint, isBad: false, isHash: true, alwaysShow: true });
        
        const isBadBrowser = riskScore >= 3;
        const verdict = isBadBrowser ? "High Risk Profile Detected" : "Profile Appears Normal";
        
        let resultsHTML = `<div class="verdict-box ${isBadBrowser ? 'danger' : 'safe'}"><i class="fa-solid ${isBadBrowser ? 'fa-user-secret' : 'fa-user-check'} fa-lg"></i><span>${verdict}</span></div>`;
        resultsHTML += `<div class="risk-score">Threat Score: <strong>${riskScore}</strong></div>`;
        const displayableRiskFactors = riskFactors.filter(factor => factor.isBad || factor.alwaysShow);
        let detailsGrid = displayableRiskFactors.map((factor) => {
            let valueClass = 'value'; if (factor.isBad) valueClass += ' danger'; else if (!factor.isHash) valueClass += ' safe'; if (factor.isHash) valueClass += ' fingerprint-hash';
            let labelHTML = `<div class="label">${factor.label}:</div>`; let valueHTML = `<div class="${valueClass}">${factor.value}</div>`;
            return labelHTML + valueHTML;
        }).join('');
        resultsHTML += `<div class="details-grid">${displayableRiskFactors.length > 0 ? detailsGrid : '...'}</div>`;
        resultsHTML += `<div class="results-footer"><button id="reset-btn" onclick="showIntro()">Scan Another Profile</button></div>`;
        
        return {html: resultsHTML, bad: isBadBrowser};
    })();
    
    const [result] = await Promise.all([detectionPromise, minDelay]);
    document.getElementById('scan-complete-sound').play();
    resultsEl.innerHTML = result.html;
    setBackgroundState(result.bad ? 'danger' : 'safe');
    const resetButton = document.getElementById('reset-btn');
    if (resetButton) { resetButton.classList.add(result.bad ? 'danger-button' : 'safe-button'); }
  }
  
  function getCanvasEntropy() {try {const c=document.createElement('canvas'); const ctx=c.getContext('2d'); ctx.fillStyle="rgb(255,255,255)"; ctx.fillRect(0,0,c.width,c.height); c.width=200;c.height=50;ctx.textBaseline="top";ctx.font="14px 'Arial'";ctx.fillText("BrowserFP",2,2);return hashString(c.toDataURL())}catch{return null}}
  function hashString(s){let h=0;for(let i=0;i<s.length;i++){h=((h<<5)-h)+s.charCodeAt(i);h|=0}return h}
  function getWebGLInfo(){try{const c=document.createElement('canvas');const gl=c.getContext('webgl')||c.getContext('experimental-webgl');if(!gl){return{vendor:"N/A",renderer:"N/A"}}const dbg=gl.getExtension('WEBGL_debug_renderer_info');return{vendor:gl.getParameter(dbg.UNMASKED_VENDOR_WEBGL),renderer:gl.getParameter(dbg.UNMASKED_RENDERER_WEBGL)}}catch{return{vendor:"N/A",renderer:"N/A"}}}
  
  function initializeContactForm() {
    const form = document.getElementById('contact-form'); if(!form) return;
    const captchaLabel = document.getElementById('captcha-label'), captchaInput = document.getElementById('captcha-input');
    const submitBtn = document.getElementById('submit-btn'), formResponse = document.getElementById('form-response');
    let num1, num2, answer;
    function generateCaptcha() {
        num1 = Math.floor(Math.random() * 10) + 1; num2 = Math.floor(Math.random() * 10) + 1; answer = num1 + num2;
        captchaLabel.textContent = `Calculate: ${num1} + ${num2} =`; captchaInput.value = '';
    }
    form.addEventListener('submit', async function(e) {
        e.preventDefault();
        if (parseInt(captchaInput.value, 10) !== answer) {
            formResponse.textContent = 'ERROR: Incorrect Security Code'; formResponse.className = 'error'; generateCaptcha(); return;
        }
        submitBtn.disabled = true; submitBtn.textContent = 'TRANSMITTING...'; formResponse.textContent = '';
        const formData = {
            name: document.getElementById('contact-name').value, email: document.getElementById('contact-email').value,
            title: document.getElementById('contact-title').value, description: document.getElementById('contact-description').value
        };
        try {
            const response = await fetch('/api/contact', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(formData) });
            const result = await response.json();
            if (response.ok) {
                formResponse.textContent = `SUCCESS: Your ticket ID is ${result.ticketId}`; formResponse.className = 'success'; form.reset();
            } else { throw new Error(result.message || 'Server rejected the transmission.'); }
        } catch (error) {
            formResponse.textContent = `TRANSMISSION FAILED: ${error.message}`; formResponse.className = 'error';
        } finally {
            submitBtn.disabled = false; submitBtn.textContent = 'Transmit Securely'; generateCaptcha();
        }
    });
    generateCaptcha();
  }

  const canvas = document.getElementById('matrix-bg'), ctx = canvas.getContext('2d');
  let backgroundInterval;
  const setupCanvas = () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; setBackgroundState('default'); };
  const drawMatrix = (color, speed, charSet) => {
    const characters = charSet; const fontSize = 14; const columns = canvas.width / fontSize;
    const drops = Array(Math.floor(columns)).fill(1);
    const bg = body.classList.contains('light-mode') ? 'rgba(244, 244, 248, 0.05)' : 'rgba(13, 13, 18, 0.05)';
    return setInterval(() => {
        ctx.fillStyle = bg; ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = color; ctx.font = fontSize + 'px Roboto Mono';
        for (let i = 0; i < drops.length; i++) {
            const text = characters[Math.floor(Math.random() * characters.length)];
            ctx.fillText(text, i * fontSize, drops[i] * fontSize);
            if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
            drops[i]++;
        }
    }, speed);
  }
  let gridOffset = 0;
  const drawBlueGrid = () => {
    const gridColor = body.classList.contains('light-mode') ? 'rgba(0, 170, 255, 0.2)' : 'rgba(0, 170, 255, 0.15)';
    return setInterval(() => {
        ctx.clearRect(0, 0, canvas.width, canvas.height); ctx.strokeStyle = gridColor; ctx.lineWidth = 1; gridOffset = (gridOffset + 0.3) % 40;
        for (let x = -gridOffset; x < canvas.width; x += 40) { ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, canvas.height); ctx.stroke(); }
        for (let y = -gridOffset; y < canvas.height; y += 40) { ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(canvas.width, y); ctx.stroke(); }
    }, 50);
  }
  function setBackgroundState(state) {
      clearInterval(backgroundInterval); ctx.clearRect(0, 0, canvas.width, canvas.height);
      const isLight = body.classList.contains('light-mode');
      if (state === 'danger' || state === 'scanning') {
          const color = state === 'scanning' ? 'rgba(255, 71, 87, 0.8)' : 'rgba(255, 71, 87, 0.7)';
          backgroundInterval = drawMatrix(color, 25, '01');
          body.classList.add('danger-mode'); body.classList.remove('safe-mode');
      } else if (state === 'safe') {
          backgroundInterval = isLight ? drawMatrix('rgba(0, 0, 0, 0.1)', 50, '01') : drawBlueGrid();
          body.classList.add('safe-mode'); body.classList.remove('danger-mode');
      } else {
          backgroundInterval = isLight ? drawMatrix('rgba(0, 0, 0, 0.1)', 50, '01') : drawMatrix('rgba(0, 255, 136, 0.7)', 40, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789');
          body.classList.remove('safe-mode', 'danger-mode');
      }
  }
  window.addEventListener('resize', setupCanvas);
</script>

</body>
</html>